<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Fire Tournaments</title>
    <link href="https://fonts.googleapis.com/css2?family=Russo+One:wght@400&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #F8FAFC;
            --bg-secondary: #E2E8F0;
            --text-dark: #1E293B;
            --accent-blue: #2563EB;
            --accent-gold: #FBBF24;
            --accent-red: #DC2626;
            --border: #CBD5E1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Russo One', sans-serif;
            background: var(--bg-primary);
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 100vw;
            margin: 0 auto;
            padding: 0 16px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--accent-blue), #1E40AF);
            color: white;
            padding: 16px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .wallet-balance {
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        /* Navigation */
        .nav {
            background: white;
            padding: 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            position: sticky;
            top: 72px;
            z-index: 99;
        }

        .nav-tabs {
            display: flex;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .nav-tabs::-webkit-scrollbar {
            display: none;
        }

        .nav-tab {
            flex: 1;
            min-width: 120px;
            padding: 16px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .nav-tab.active {
            color: var(--accent-blue);
            border-bottom-color: var(--accent-blue);
        }

        /* Main Content */
        .main {
            min-height: calc(100vh - 144px);
            padding: 20px 0;
        }

        .section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--accent-blue), #1E40AF);
            color: white;
            padding: 40px 20px;
            text-align: center;
            margin: -20px -16px 20px -16px;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 16px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .hero p {
            font-size: 1.1rem;
            margin-bottom: 24px;
            opacity: 0.9;
        }

        .cta-button {
            background: var(--accent-gold);
            color: var(--text-dark);
            padding: 16px 32px;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(251, 191, 36, 0.6);
        }

        /* Tournament Cards */
        .tournament-grid {
            display: grid;
            gap: 16px;
            margin-top: 20px;
        }

        .tournament-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .tournament-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .tournament-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .tournament-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--text-dark);
        }

        .tournament-status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-live {
            background: #FEE2E2;
            color: var(--accent-red);
        }

        .status-upcoming {
            background: #DBEAFE;
            color: var(--accent-blue);
        }

        .tournament-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .detail-item i {
            color: var(--accent-blue);
            width: 16px;
        }

        .tournament-prize {
            background: linear-gradient(135deg, var(--accent-gold), #F59E0B);
            color: white;
            padding: 12px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 16px;
        }

        .join-button {
            width: 100%;
            background: var(--accent-blue);
            color: white;
            padding: 12px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .join-button:hover {
            background: #1E40AF;
            transform: translateY(-1px);
        }

        .join-button:disabled {
            background: var(--border);
            cursor: not-allowed;
            transform: none;
        }

        /* Referral Section */
        .referral-card {
            background: linear-gradient(135deg, var(--accent-gold), #F59E0B);
            color: white;
            padding: 24px;
            border-radius: 16px;
            margin-bottom: 20px;
            text-align: center;
        }

        .referral-code {
            background: rgba(255,255,255,0.2);
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: bold;
            margin: 16px 0;
            letter-spacing: 2px;
        }

        .share-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 16px;
        }

        .share-button {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 12px 16px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .share-button:hover {
            background: rgba(255,255,255,0.3);
        }

        .earnings-card {
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        /* Profile Section */
        .profile-header {
            background: white;
            padding: 24px;
            border-radius: 16px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--accent-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 2rem;
            color: white;
        }

        .profile-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-top: 16px;
        }

        .info-item {
            text-align: left;
        }

        .info-label {
            font-size: 0.8rem;
            color: #64748B;
            margin-bottom: 4px;
        }

        .info-value {
            font-size: 1rem;
            font-weight: bold;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 20px;
        }

        .action-button {
            background: var(--accent-blue);
            color: white;
            padding: 12px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-button.secondary {
            background: var(--bg-secondary);
            color: var(--text-dark);
        }

        /* Registrations List */
        .registrations-list {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .registration-item {
            padding: 16px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .registration-item:last-child {
            border-bottom: none;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 24px;
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .close-button {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #64748B;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--text-dark);
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        /* Tournament Tabs */
        .tournament-tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 4px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .tournament-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: none;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tournament-tab.active {
            background: var(--accent-blue);
            color: white;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .tournament-details {
                grid-template-columns: 1fr;
            }
            
            .profile-info {
                grid-template-columns: 1fr;
            }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Success/Error Messages */
        .message {
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-weight: bold;
        }

        .message.success {
            background: #D1FAE5;
            color: #065F46;
            border: 1px solid #A7F3D0;
        }

        .message.error {
            background: #FEE2E2;
            color: #991B1B;
            border: 1px solid #FECACA;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-trophy"></i> FF Tournaments
                </div>
                <div class="wallet-balance">
                    <i class="fas fa-wallet"></i> ₹<span id="walletBalance">500</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="container">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showSection('home')">
                    <i class="fas fa-home"></i> Home
                </button>
                <button class="nav-tab" onclick="showSection('tournaments')">
                    <i class="fas fa-trophy"></i> Tournaments
                </button>
                <button class="nav-tab" onclick="showSection('referral')">
                    <i class="fas fa-share-alt"></i> Refer & Earn
                </button>
                <button class="nav-tab" onclick="showSection('profile')">
                    <i class="fas fa-user"></i> Profile
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Home Section -->
            <section id="home" class="section active">
                <div class="hero">
                    <h1>Free Fire Tournaments</h1>
                    <p>Join epic battles and win amazing prizes!</p>
                    <button class="cta-button" onclick="showSection('tournaments')">
                        <i class="fas fa-play"></i> Play Now
                    </button>
                </div>

                <div class="tournament-grid">
                    <div class="tournament-card">
                        <div class="tournament-header">
                            <div class="tournament-title">Weekend Clash</div>
                            <div class="tournament-status status-live">LIVE</div>
                        </div>
                        <div class="tournament-details">
                            <div class="detail-item">
                                <i class="fas fa-clock"></i>
                                <span>2:00 PM Today</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-map"></i>
                                <span>Bermuda</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-users"></i>
                                <span>45/100 Players</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-coins"></i>
                                <span>₹50 Entry</span>
                            </div>
                        </div>
                        <div class="tournament-prize">
                            <i class="fas fa-trophy"></i> Prize Pool: ₹2,500
                        </div>
                        <button class="join-button" onclick="openJoinModal('weekend-clash')">
                            Join Tournament
                        </button>
                    </div>

                    <div class="tournament-card">
                        <div class="tournament-header">
                            <div class="tournament-title">Pro League</div>
                            <div class="tournament-status status-upcoming">UPCOMING</div>
                        </div>
                        <div class="tournament-details">
                            <div class="detail-item">
                                <i class="fas fa-clock"></i>
                                <span>6:00 PM Today</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-map"></i>
                                <span>Kalahari</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-users"></i>
                                <span>12/50 Players</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-coins"></i>
                                <span>₹100 Entry</span>
                            </div>
                        </div>
                        <div class="tournament-prize">
                            <i class="fas fa-trophy"></i> Prize Pool: ₹3,000
                        </div>
                        <button class="join-button" onclick="openJoinModal('pro-league')">
                            Join Tournament
                        </button>
                    </div>
                </div>
            </section>

            <!-- Tournaments Section -->
            <section id="tournaments" class="section">
                <div class="tournament-tabs">
                    <button class="tournament-tab active" onclick="showTournamentTab('live')">Live</button>
                    <button class="tournament-tab" onclick="showTournamentTab('upcoming')">Upcoming</button>
                    <button class="tournament-tab" onclick="showTournamentTab('past')">Past</button>
                </div>

                <div id="live-tournaments" class="tournament-grid">
                    <!-- Live tournaments will be loaded here -->
                </div>

                <div id="upcoming-tournaments" class="tournament-grid" style="display: none;">
                    <!-- Upcoming tournaments will be loaded here -->
                </div>

                <div id="past-tournaments" class="tournament-grid" style="display: none;">
                    <!-- Past tournaments will be loaded here -->
                </div>
            </section>

            <!-- Referral Section -->
            <section id="referral" class="section">
                <div class="referral-card">
                    <h2><i class="fas fa-gift"></i> Refer Friends & Earn</h2>
                    <p>Get ₹25 for every friend who joins using your code!</p>
                    <div class="referral-code" id="referralCode">FF2025XYZ</div>
                    <div class="share-buttons">
                        <button class="share-button" onclick="shareReferral('whatsapp')">
                            <i class="fab fa-whatsapp"></i> WhatsApp
                        </button>
                        <button class="share-button" onclick="shareReferral('telegram')">
                            <i class="fab fa-telegram"></i> Telegram
                        </button>
                        <button class="share-button" onclick="copyReferralCode()">
                            <i class="fas fa-copy"></i> Copy Link
                        </button>
                    </div>
                </div>

                <div class="earnings-card">
                    <h3><i class="fas fa-chart-line"></i> Your Earnings</h3>
                    <div class="profile-info">
                        <div class="info-item">
                            <div class="info-label">Total Referrals</div>
                            <div class="info-value">8 Friends</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Earnings</div>
                            <div class="info-value">₹200</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">This Month</div>
                            <div class="info-value">3 Referrals</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Pending</div>
                            <div class="info-value">₹75</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profile Section -->
            <section id="profile" class="section">
                <div class="profile-header">
                    <div class="profile-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <h2 id="userName">Rohan Sharma</h2>
                    <p style="color: #64748B;">Level 15 Player</p>
                    
                    <div class="profile-info">
                        <div class="info-item">
                            <div class="info-label">Free Fire UID</div>
                            <div class="info-value">987654321</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Wallet Balance</div>
                            <div class="info-value">₹500</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Tournaments Won</div>
                            <div class="info-value">3</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Total Earnings</div>
                            <div class="info-value">₹1,250</div>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="action-button" onclick="openTopupModal()">
                            <i class="fas fa-plus"></i> Top-up Wallet
                        </button>
                        <button class="action-button secondary" onclick="editProfile()">
                            <i class="fas fa-edit"></i> Edit Profile
                        </button>
                    </div>
                </div>

                <div class="registrations-list">
                    <h3 style="padding: 16px; margin: 0; border-bottom: 1px solid var(--border);">
                        <i class="fas fa-list"></i> My Registrations
                    </h3>
                    <div class="registration-item">
                        <div>
                            <div style="font-weight: bold;">Weekend Clash</div>
                            <div style="color: #64748B; font-size: 0.9rem;">Today 2:00 PM</div>
                        </div>
                        <button class="action-button" style="padding: 8px 16px; font-size: 0.9rem;">
                            View Details
                        </button>
                    </div>
                    <div class="registration-item">
                        <div>
                            <div style="font-weight: bold;">Pro League</div>
                            <div style="color: #64748B; font-size: 0.9rem;">Today 6:00 PM</div>
                        </div>
                        <button class="action-button" style="padding: 8px 16px; font-size: 0.9rem; background: var(--accent-red);">
                            Cancel
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Join Tournament Modal -->
    <div id="joinModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Join Tournament</h3>
                <button class="close-button" onclick="closeModal('joinModal')">&times;</button>
            </div>
            <div id="joinModalContent">
                <div class="form-group">
                    <label class="form-label">Tournament</label>
                    <input type="text" class="form-input" id="tournamentName" readonly>
                </div>
                <div class="form-group">
                    <label class="form-label">Player Name</label>
                    <input type="text" class="form-input" id="playerName" value="Rohan Sharma">
                </div>
                <div class="form-group">
                    <label class="form-label">Free Fire UID</label>
                    <input type="text" class="form-input" id="playerUID" value="987654321">
                </div>
                <div class="form-group">
                    <label class="form-label">Entry Fee</label>
                    <input type="text" class="form-input" id="entryFee" readonly>
                </div>
                <button class="join-button" onclick="confirmJoin()">
                    <i class="fas fa-credit-card"></i> Pay & Join Tournament
                </button>
            </div>
        </div>
    </div>

    <!-- Top-up Modal -->
    <div id="topupModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Top-up Wallet</h3>
                <button class="close-button" onclick="closeModal('topupModal')">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Amount</label>
                <select class="form-input" id="topupAmount">
                    <option value="100">₹100</option>
                    <option value="250">₹250</option>
                    <option value="500">₹500</option>
                    <option value="1000">₹1000</option>
                </select>
            </div>
            <button class="join-button" onclick="processTopup()">
                <i class="fas fa-credit-card"></i> Pay Now
            </button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>

    <!-- Razorpay SDK -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "your-api-key",
            authDomain: "your-project.firebaseapp.com",
            projectId: "your-project-id",
            storageBucket: "your-project.appspot.com",
            messagingSenderId: "123456789",
            appId: "your-app-id"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // Current user data
        let currentUser = {
            id: 'user123',
            name: 'Rohan Sharma',
            uid: '987654321',
            walletBalance: 500,
            referralCode: 'FF2025XYZ'
        };

        // Sample tournament data
        const tournaments = {
            live: [
                {
                    id: 'weekend-clash',
                    title: 'Weekend Clash',
                    time: '2:00 PM Today',
                    map: 'Bermuda',
                    prize: 2500,
                    entryFee: 50,
                    players: 45,
                    maxPlayers: 100,
                    status: 'live'
                }
            ],
            upcoming: [
                {
                    id: 'pro-league',
                    title: 'Pro League',
                    time: '6:00 PM Today',
                    map: 'Kalahari',
                    prize: 3000,
                    entryFee: 100,
                    players: 12,
                    maxPlayers: 50,
                    status: 'upcoming'
                },
                {
                    id: 'night-battle',
                    title: 'Night Battle',
                    time: '9:00 PM Today',
                    map: 'Purgatory',
                    prize: 5000,
                    entryFee: 200,
                    players: 5,
                    maxPlayers: 25,
                    status: 'upcoming'
                }
            ],
            past: [
                {
                    id: 'morning-rush',
                    title: 'Morning Rush',
                    time: '10:00 AM Today',
                    map: 'Bermuda',
                    prize: 1500,
                    entryFee: 25,
                    players: 80,
                    maxPlayers: 80,
                    status: 'completed'
                }
            ]
        };

        // Navigation functions
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Update nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Load section-specific data
            if (sectionId === 'tournaments') {
                loadTournaments('live');
            }
        }

        function showTournamentTab(tabId) {
            // Hide all tournament lists
            document.querySelectorAll('[id$="-tournaments"]').forEach(list => {
                list.style.display = 'none';
            });
            
            // Show selected list
            document.getElementById(tabId + '-tournaments').style.display = 'block';
            
            // Update tab buttons
            document.querySelectorAll('.tournament-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Load tournaments for selected tab
            loadTournaments(tabId);
        }

        function loadTournaments(category) {
            const container = document.getElementById(category + '-tournaments');
            const tournamentList = tournaments[category] || [];
            
            container.innerHTML = '';
            
            tournamentList.forEach(tournament => {
                const card = createTournamentCard(tournament);
                container.appendChild(card);
            });
        }

        function createTournamentCard(tournament) {
            const card = document.createElement('div');
            card.className = 'tournament-card';
            
            const statusClass = tournament.status === 'live' ? 'status-live' : 
                              tournament.status === 'upcoming' ? 'status-upcoming' : 'status-completed';
            
            card.innerHTML = `
                <div class="tournament-header">
                    <div class="tournament-title">${tournament.title}</div>
                    <div class="tournament-status ${statusClass}">${tournament.status.toUpperCase()}</div>
                </div>
                <div class="tournament-details">
                    <div class="detail-item">
                        <i class="fas fa-clock"></i>
                        <span>${tournament.time}</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-map"></i>
                        <span>${tournament.map}</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-users"></i>
                        <span>${tournament.players}/${tournament.maxPlayers} Players</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-coins"></i>
                        <span>₹${tournament.entryFee} Entry</span>
                    </div>
                </div>
                <div class="tournament-prize">
                    <i class="fas fa-trophy"></i> Prize Pool: ₹${tournament.prize}
                </div>
                <button class="join-button" onclick="openJoinModal('${tournament.id}')" 
                        ${tournament.status === 'completed' ? 'disabled' : ''}>
                    ${tournament.status === 'completed' ? 'Completed' : 'Join Tournament'}
                </button>
            `;
            
            return card;
        }

        // Modal functions
        function openJoinModal(tournamentId) {
            const tournament = findTournamentById(tournamentId);
            if (!tournament) return;

            document.getElementById('tournamentName').value = tournament.title;
            document.getElementById('entryFee').value = `₹${tournament.entryFee}`;
            document.getElementById('joinModal').classList.add('active');
        }

        function openTopupModal() {
            document.getElementById('topupModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function findTournamentById(id) {
            for (const category in tournaments) {
                const tournament = tournaments[category].find(t => t.id === id);
                if (tournament) return tournament;
            }
            return null;
        }

        // Tournament join function
        async function confirmJoin() {
            const tournamentName = document.getElementById('tournamentName').value;
            const playerName = document.getElementById('playerName').value;
            const playerUID = document.getElementById('playerUID').value;
            const entryFee = parseInt(document.getElementById('entryFee').value.replace('₹', ''));

            if (!playerName || !playerUID) {
                showMessage('Please fill all fields', 'error');
                return;
            }

            if (currentUser.walletBalance < entryFee) {
                showMessage('Insufficient wallet balance. Please top-up your wallet.', 'error');
                return;
            }

            try {
                // Process payment
                await processPayment(entryFee);
                
                // Join tournament
                await joinTournament(tournamentName, currentUser.id);
                
                // Update wallet balance
                currentUser.walletBalance -= entryFee;
                updateWalletDisplay();
                
                showMessage('Successfully joined tournament!', 'success');
                closeModal('joinModal');
                
            } catch (error) {
                showMessage('Failed to join tournament. Please try again.', 'error');
            }
        }

        // Payment processing
        async function processPayment(amount) {
            return new Promise((resolve, reject) => {
                const options = {
                    key: 'rzp_test_your_key_here', // Replace with your Razorpay key
                    amount: amount * 100, // Amount in paise
                    currency: 'INR',
                    name: 'FF Tournaments',
                    description: 'Tournament Entry Fee',
                    handler: function(response) {
                        console.log('Payment successful:', response);
                        resolve(response);
                    },
                    prefill: {
                        name: currentUser.name,
                        email: 'user@example.com'
                    },
                    theme: {
                        color: '#2563EB'
                    }
                };

                const rzp = new Razorpay(options);
                rzp.on('payment.failed', function(response) {
                    console.log('Payment failed:', response);
                    reject(response);
                });
                rzp.open();
            });
        }

        // Top-up wallet
        async function processTopup() {
            const amount = parseInt(document.getElementById('topupAmount').value);
            
            try {
                await processPayment(amount);
                currentUser.walletBalance += amount;
                updateWalletDisplay();
                showMessage(`Successfully added ₹${amount} to wallet!`, 'success');
                closeModal('topupModal');
            } catch (error) {
                showMessage('Payment failed. Please try again.', 'error');
            }
        }

        // Firebase functions
        async function joinTournament(tournamentName, userId) {
            try {
                await db.collection('tournaments').doc(tournamentName).collection('registrations').add({
                    userId: userId,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    playerName: currentUser.name,
                    playerUID: currentUser.uid
                });

                await db.collection('users').doc(userId).update({
                    walletBalance: currentUser.walletBalance
                });

                console.log('Tournament joined successfully');
            } catch (error) {
                console.error('Error joining tournament:', error);
                throw error;
            }
        }

        // Referral functions
        function shareReferral(platform) {
            const referralText = `Join FF Tournaments using my referral code ${currentUser.referralCode} and get ₹25 bonus! Download: https://fftournaments.com/ref/${currentUser.referralCode}`;
            
            switch (platform) {
                case 'whatsapp':
                    window.open(`https://wa.me/?text=${encodeURIComponent(referralText)}`);
                    break;
                case 'telegram':
                    window.open(`https://t.me/share/url?url=https://fftournaments.com/ref/${currentUser.referralCode}&text=${encodeURIComponent(referralText)}`);
                    break;
            }
        }

        function copyReferralCode() {
            const referralText = `https://fftournaments.com/ref/${currentUser.referralCode}`;
            navigator.clipboard.writeText(referralText).then(() => {
                showMessage('Referral link copied to clipboard!', 'success');
            });
        }

        // Utility functions
        function updateWalletDisplay() {
            document.getElementById('walletBalance').textContent = currentUser.walletBalance;
        }

        function showMessage(text, type) {
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.remove();
            }, 3000);
        }

        function editProfile() {
            showMessage('Profile editing feature coming soon!', 'success');
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Load initial data
            loadTournaments('live');
            updateWalletDisplay();
            
            // Set up Firebase auth listener
            auth.onAuthStateChanged(user => {
                if (user) {
                    console.log('User signed in:', user);
                    // Load user data from Firestore
                } else {
                    console.log('User signed out');
                    // Redirect to login or show guest mode
                }
            });
        });

        // Close modals when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.classList.remove('active');
                }
            });
        }
    </script>
</body>
</html>